import pandas as pdimport numpy as npimport matplotlib.pyplot as pltimport matplotlib as mpl# import kerasdata = pd.DataFrame(pd.read_csv('IO/tran_attr.csv',                                usecols=['A', 'B', 'C', 'D1', 'D2', 'D4', 'D5', 'E1', 'E2', 'E3', 'E4', 'F11', 'F12', 'F13',                                         'F14', 'F21', 'F22', 'F23', 'F24','F25', 'F26', 'F31', 'F32', 'F33', 'F35', 'G', 'H']))# 'D3' has no data# 'F34' all 1163 0sdig_cols=['A', 'B', 'D1', 'D2', 'D4', 'D5', 'E2', 'E3', 'E4', 'F11', 'F12', 'F13',          'F14', 'F21', 'F22', 'F23', 'F24','F25','G' ]str_cols=[ 'C', 'E1','H'] # transformed to one-hotfill_dig_cols=['F26','F31','F32','F33','F35'] # F26 fill with average, else fill with '0'to = ['A','E4','F14','F21','F22','F23','G'] # G 可以平滑也可以不平滑def plot_dig(object_name):    plt.hist(data[object_name], len(set(data[object_name])), normed=False, facecolor='green', alpha=0.5)    plt.title(object_name)    plt.show()def draw_bar(labels,quants,object_name):    width = 0.3    ind = np.linspace(1.5,4.5,len(set(data[object_name])))    # make a square figure    fig = plt.figure(1)    ax  = fig.add_subplot(111)    # Bar Plot    ax.bar(ind-width/2,quants,width,color='green')    # Set the ticks on x-axis    ax.set_xticks(ind)    ax.set_xticklabels(labels)    # labels    # ax.set_xlabel('Country')    # ax.set_ylabel('GDP (Billion US dollar)')    # title    ax.set_title(object_name)    plt.grid(True)    plt.show()    # plt.savefig("bar.png")    plt.close()def plot_strs(object_name):    counts = data[object_name].value_counts()    print(counts)    labels = counts.keys()    quants = counts.values    draw_bar(labels,quants,object_name)def count(object_name):    counts = data[object_name].value_counts()    quants = counts.values    print('----' + object_name + '-----')    print('sum:   %d'  %sum(quants))    print(counts)    print('\r')# --------------------------------------# 打印出整体信息，并且，打印出有空值的列的情况，作为参考print(data.info())for i in fill_dig_cols:    count(i)def smooth(object_name):    data[object_name] = data[object_name].apply(lambda x: np.log2(x+3.5))# 对['A','E4','F14','F21','F22','F23','G']做平滑for i in to:    smooth(i)# data['A'] = data['A'].apply(lambda x: np.log10(x+3.5))def average(object_name):    sum = 0    cou = 0    for i in data[object_name]:        if not(i != i):            cou = cou+1            sum = sum+i    print(object_name+'平均值为：%f' %(sum/cou))    return(sum/cou)    # 对 F26 填充平均值data['F26']=data['F26'].fillna(average('F26'))# 对 31 F32 F33 F35 填充 0for i in set(fill_dig_cols).difference(set('F26')):    data[i] = data[i].fillna(0)    def normalization(object_name):    dif = max(data[object_name])-min(data[object_name])    aver = average(object_name)    data[object_name] = data[object_name].apply(lambda x: (x - aver) / dif)for i in fill_dig_cols:    normalization(i)for i in dig_cols:    normalization(i)for i in to:    print(i, len(set(data[i])), set(data[i]))    # for i in str_colspd.DataFrame.to_csv(data, 'IO/nor_1.csv', index=None)# 完成空值填充、归一化